This is a modified version of the algorithm that only addresses partitioning. 
